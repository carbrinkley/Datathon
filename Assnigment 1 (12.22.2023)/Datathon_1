# -*- coding: utf-8 -*-
"""Datathon#1

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1aqMmw74OsGvMicxC41hetgSAYqzkcfIl

The code's purpose is to process images stored in a zip file named 'faceimage.zip.' Upon successful execution, it will determine the gender, race/ethnicity, and age of individuals in the images. The results will be compiled into a CSV file. To run the code, ensure you have deepface installed.
"""

!cp /content/drive/MyDrive/Datathon#1/faceimages.zip .

!unzip faceimages.zip

!pip install deepface

import os
from deepface import DeepFace
import pandas as pd

# Function to process images and extract gender, race, and age
def process_images(image_folder):
    data = []
    for filename in os.listdir(image_folder):
        if filename.endswith(".jpg") or filename.endswith(".png"):
            image_path = os.path.join(image_folder, filename)

            # Modify this line to include enforce_detection=False
            result = DeepFace.analyze(image_path, actions=['gender', 'race', 'age'], enforce_detection=False)

            # Extracting gender, race, and age from the result
            gender = result[0]['gender']
            race = result[0]['dominant_race']
            age = result[0]['age']

            # Appending data to the list
            data.append({'Filename': filename, 'Gender': gender, 'Race/ethnicity': race, 'Age': age})

    return data

# Set the path to the image folder
image_folder_path = 'faceimages'

# Process images and create a DataFrame
data = process_images(image_folder_path)
df = pd.DataFrame(data)

# Write the DataFrame to a CSV file
df.to_csv('output.csv', index=False)
